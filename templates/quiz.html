{% extends 'base.html' %}
{% block content %}
<h2>Quiz: {{ set.title }}</h2>
{% if finished %}
<div class="quiz-results">

    <div class="score-card">
        <h3>Your Score</h3>
        <p class="score">{{ score }} / {{ questions|length }}</p>
    </div>

    <div class="question-cards">
        {% for r in results %}
        <div class="question-card {% if r.is_correct %}correct{% else %}incorrect{% endif %}">
            <p class="question-text">
                {{ loop.index }}. {{ r.question.question_text }}
            </p>

            {% if r.is_correct %}
                <p class="answer correct-answer">
                    ‚úÖ Correct: {{ r.correct_text }}
                </p>
            {% else %}
                <p class="answer user-answer">
                    ‚ùå Your answer: {{ r.selected_text or "No answer" }}
                </p>
                <p class="answer correct-answer">
                    ‚úî Correct answer: {{ r.correct_text }}
                </p>
            {% endif %}
        </div>
        {% endfor %}
    </div>

    <div class="quiz-nav sticky">
        <a href="{{ url_for('take_quiz', set_id=set.id) }}" class="btn btn-primary">
            üîÅ Retake Quiz
        </a>

        <a href="{{ url_for('edit_set', set_id=set.id) }}" class="btn btn-secondary">
            üìö Back to Set
        </a>

        <a href="{{ url_for('index') }}" class="btn btn-secondary">
            üè† Home
        </a>
    </div>

</div>
{% else %}

    <form method="POST">
        {% for q in questions %}
            <div>
                <p>{{ q.question_text }}</p>
                <input type="radio" name="{{ q.id }}" value="A"> A. {{ q.option_a }}<br>
                <input type="radio" name="{{ q.id }}" value="B"> B. {{ q.option_b }}<br>
                <input type="radio" name="{{ q.id }}" value="C"> C. {{ q.option_c }}<br>
                <input type="radio" name="{{ q.id }}" value="D"> D. {{ q.option_d }}<br>
            </div>
        {% endfor %}
        <input type="submit" value="Submit Quiz">
    </form>
{% endif %}

{% endblock %}
